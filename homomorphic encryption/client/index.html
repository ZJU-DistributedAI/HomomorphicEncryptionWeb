<!--
Copyright 2018 Google LLC. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
==============================================================================
-->

<html>

<head>
  <title>Partially Encrypted Deep Neural Network for Enhancing Privacy</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./shared/tfjs-examples.css" type="text/css" />
  <script src="./shared/jquery-3.4.0.min.js"></script>

  <style>
    #train {
      margin-top: 10px;
    }

    label {
      display: inline-block;
      width: 250px;
      padding: 6px 0 6px 0;
    }

    .canvases {
      display: inline-block;
    }

    .prediction-canvas {
      width: 100px;
    }

    .pred {
      font-size: 20px;
      line-height: 25px;
      width: 100px;
    }

    .pred-correct {
      background-color: #00cf00;
    }

    .pred-incorrect {
      background-color: red;
    }

    .pred-container {
      display: inline-block;
      width: 100px;
      margin: 10px;
    }
  </style>
</head>

<body>
  <div class="tfjs-example-container">
    <section class='title-area'>
      <h1>Partially Encrypted Deep Neural Network for Enhancing Privacy</h1>
      <p class='subtitle'>Train a model with encrpted model layer
      </p>
    </section>

    <section>
      <p class='section-head'>Description</p>
      <p>
        This examples we propose a deep neural network system that aims to solve privacy 
        issue for both the data owner (protecting both the original data and predicted result) 
        and model owner. Our system is partially encrypted, which significantly reduces computation 
        and communication costs comparing to encrypting the entire model.
      </p>
      <p>The MNIST dataset is used as training data.</p>
    </section>


    <section>
        <p class='section-head'>Init Model</p>
  
        <button id="init_model" onclick="loginInit()">Init Model</button>
  
      </section>
      <section>
          <p id="init_model_result_w1"></p>
          <p id="init_model_result_w2"></p>
          <p id="init_model_result_b1"></p>
          <p id="init_model_result_b2"></p>
        </section>


      

    <section>
      <p class='section-head'>Generate Homomorphic Encryption Key</p>
      <p>
        This examples to generate homomorphic encryption key
      </p>

      <button id="generate_key" onclick="generateKey()">Generate homomorphic encryption key</button>

    </section>

    <section>
      <p id='public_key_description'></p>
      <p id='status_generated_public_key'></p>
      <p id='private_key_description'></p>
      <p id='status_generated_private_key'></p>
    </section>



    <section>
      <p class='section-head'>Put Public Homomorphic Encryption Key To Server</p>
      <p>
        This examples to put public homomorphic encryption key to server
      </p>

      <button id="put_key" onclick="putKey()">Put homomorphic encryption key</button>

    </section>

    <section>
      <p id="status_put_key"></p>
      <p id="message_put_key"></p>
    </section>


    <section>
        <p class='section-head'>Get Model From Server</p>
  
        <button id="get_model" onclick="getModel()">Get Model From Server</button>
  
      </section>
      <section>
          <p id="show_model"></p>
      </section>

      <section>
          <p class='section-head'>Train</p>
    
          <button id="train_model" onclick="trainModel()">Train</button>
    
        </section>
        <section>
            <p id="show_process"></p>
        </section>


        <!-- <section>
            <p class='section-head'>Check Current Model</p>
      
            <button id="check_current_model" onclick="trainModel()">Check Current Model</button>
      
          </section>
          <section>
              <p id="check_current_w1_result"></p>
              <p id="check_current_w2_result"></p>
              <p id="check_current_b1_result"></p>
              <p id="check_current_b2_result"></p>
            </section> -->

    <!-- <section>
        <p class='section-head'>Priedict Result</p>
  
        <button id="predict_result" onclick="predictResult()" >Predict Result</button>
  
      </section>
      <section>
          <p id="show_preidct_result"></p>
      </section> -->

    <section>
      <p class='section-head'>Training Parameters</p>
      <div>
        <label>Model Type:</label>
        <select id="model-type">
          <option>ConvNet</option>
          <option>DenseNet</option>
        </select>
      </div>

      <div>
        <label># of training epochs:</label>
        <input id="train-epochs" value="3">
      </div>

      <button id="train" onclick="trainModel()">Load Data and Train Model</button>
    </section>

    <!-- <section>
      <p class='section-head'>Training Progress</p>
      <p id="status"></p>
      <p id="message"></p>

      <div id="stats">
        <div class="canvases">
          <label id="loss-label"></label>
          <div id="loss-canvas"></div>
        </div>
        <div class="canvases">
          <label id="accuracy-label"></label>
          <div id="accuracy-canvas"></div>
        </div>
      </div>
    </section> -->

    <!-- <section>
      <p class='section-head'>Inference Examples</p>
      <div id="images"></div>
    </section> -->


  </div>

  <!-- TODO(cais): Decide. DO NOT SUBMIT. -->
  <!-- <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> -->
  <!-- <script src="index.js"></script> -->
  <script type="text/javascript">
        
    const Url = "http://127.0.0.1:8081/";
    function loginInit() {
      // alert(loginInit);
      $.ajax({
        url: Url+"initModel",
        type: "GET",
        success: function(data) {
          alert(result);
          console.log("result:", result);
        },
        error: function(error) {
          alert("error:",error);
          console.log(`Error ${error}`)
        }
      });
    }
    function generateKey() {
      $.ajax({
        url: Url+"generateKey",
        type: "GET",
        success: function(data) {
          console.log(result);
        },
        error: function(error) {
          console.log(`Error ${error}`)
        }
      });
    }
    function putKey() {
      $.ajax({
        url: Url+"sendKey",
        type: "GET",
        success: function(data) {
          console.log(result);
        },
        error: function(error) {
          console.log(`Error ${error}`)
        }
      });
    }
    function getModel() {
      $.ajax({
        url: Url+"getModel",
        type: "GET",
        success: function(data) {
          console.log(result);
        },
        error: function(error) {
          console.log(`Error ${error}`)
        }
      });
    }
    function trainModel() {
      $.ajax({
        url: Url+"train",
        type: "GET",
        success: function(data) {
          console.log(result);
        },
        error: function(error) {
          console.log(`Error ${error}`)
        }
      });
    }
      // var generate_key = document.getElementById("generate_key");
      // generate_key.onclick=function(){
      //   alert("hello world generate_key");
      // }
      // var put_key = document.getElementById("put_key");
      // put_key.onclick=function(){
      //   alert("hello world put_key");
      // }
      // var get_model = document.getElementById("get_model");
      // get_model.onclick=function(){
      //   alert("hello world get_model");
      // }
      // var train_model = document.getElementById("train_model");
      // train_model.onclick=function(){
      //   alert("hello world train_model");
      // }

  </script>
</body>

</html>
